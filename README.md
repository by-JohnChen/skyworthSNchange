# 创维机顶盒串码修改工具

一款基于 PySide6 开发的图形界面工具，用于修改创维机顶盒的 MAC 地址、SN 码和账号信息，并支持设备重启、恢复出厂设置等操作。

## 版本信息

当前版本：`V0.0.3-qt-SCAN`

## 功能特点

- 支持修改机顶盒的 MAC 地址、SN 码和账号信息
- 提供设备重启和恢复出厂设置功能
- 自动搜索局域网内开启 ADB 调试的机顶盒设备
- 实时日志显示操作过程
- 支持检查设备连接状态和厂商信息

## 环境要求

- Python 3.x
- 依赖库：`PySide6`
- 机顶盒需开启 ADB 调试（默认端口：5555）
- 电脑与机顶盒需处于同一局域网

## 安装与使用

1. 克隆或下载项目到本地
2. 安装依赖库：
   ```bash
   pip install PySide6
   ```
3. 运行主程序：
   ```bash
   python main.py
   ```

## 操作步骤

1. **连接设备**：
   - 直接输入机顶盒 IP 地址，或点击"搜索设备"自动查找局域网内的设备
   - 确保机顶盒已开启 ADB 调试

2. **输入信息**：
   - 在"MAC/SN 地址"栏输入新的 MAC 地址（支持格式：XXXXXXXXXXXX 或 XX:XX:XX:XX:XX:XX）
   - 在"账号"栏输入新的账号信息（将自动添加 ottx01@ottx 后缀）

3. **选择操作**：
   - 勾选"改完重启"：修改完成后自动重启设备
   - 勾选"恢复出厂"：执行恢复出厂设置操作（谨慎使用）

4. **执行操作**：
   - 点击"确定修改 (耗时操作)"开始执行修改流程
   - 操作过程将在下方日志区域实时显示

## 其他功能

- **单独重启机顶盒**：无需修改信息，直接重启指定设备
- **杀死后台 ADB 服务**：当 ADB 连接异常时，可尝试此功能

## 注意事项

1. 确保机顶盒与电脑在同一网络下，建议设为 DHCP
2. 机顶盒必须开启 ADB 调试（端口：5555）
3. 恢复出厂设置会清除设备上的所有数据，请谨慎操作
4. 部分操作可能需要一定时间，请耐心等待，不要重复点击
5. 如遇 ADB 进程无法关闭，请尝试以管理员权限运行程序

## 界面说明

- 顶部：显示本机 IP 地址和设备连接区域
- 中间：输入信息区域和操作选项
- 下方：操作日志显示区域，记录所有操作过程和结果

## 常见问题

1. **无法找到设备**：
   - 检查机顶盒是否开启 ADB 调试
   - 确认设备与电脑在同一局域网
   - 手动输入正确的 IP 地址尝试连接

2. **修改失败**：
   - 检查网络连接是否稳定
   - 确认设备型号为创维机顶盒
   - 尝试重启设备后重新操作

3. **ADB 服务无法关闭**：
   - 尝试以管理员权限运行程序
   - 手动在任务管理器中结束 ADB 相关进程

## 开发说明

项目结构：
- `main.py`：主程序，包含 GUI 界面和核心逻辑
- `function.py`：提供各种操作的实现函数
- `CheckInput.py`：输入验证相关函数
- `ScanService.py`：局域网设备扫描服务

核心技术：
- 使用 PySide6 构建图形界面
- 采用多线程处理耗时操作，避免界面卡顿
- 通过 ADB 协议与机顶盒进行通信
